!function(e){window.HockeyDataConfig=function(){return{logoBaseUrl:"/wp-content/themes/hsc-theme/images/teams",hockeyDataApiUrl:"http://api.hockeydata.net/data/ebel",league:"ebel",sport:"icehockey",referer:"www.h-sc.at",hockeyDataApiKey:"e52b5722cbc89c3e51ee0cd6e2485a81"}}}(jQuery),function(e){"use strict";var a=jQuery.fn.addClass;jQuery.fn.addClass=function(){var e=a.apply(this,arguments);return jQuery("#main-header").removeClass("et-fixed-header"),e},e("#main-header").removeClass("et-fixed-header")}(jQuery),function(e){"use strict";function a(){var a=new HockeyDataConfig,t="136",n="halbfinale",s=function(e){var t='<table class="hsc-knockout-overview"><tr>  <td class="image">    <img src="'+a.logoBaseUrl+'/{{ teams[0].id }}.png" />  </td>  <td class="meta">    <span class="score">{{ teams[0].gamesWon }} : {{ teams[1].gamesWon }}</span><br/>    <span class="bestof">Best of: {{ bestOf }}</span>  </td>  <td class="image">    <img src="'+a.logoBaseUrl+'/{{ teams[1].id }}.png" />  </td></tr></table>';return(t=_.template(t))(e)},i=function(e){var a='<tr>  <td class="date" colspan="2">    {{ scheduledDate.value }} - {{ scheduledTime }}  </td></tr><tr>  <td class="team">{{ homeTeamLongName }} <br/> {{ awayTeamLongName }}</td>  <td class="score">{{ homeTeamScore }} : {{ awayTeamScore }}</td></tr>';return(a=_.template(a))(e)},d=function(a,t){var n='<div class="hsc-knockout">',s=o(t);n+=s,n+="</div>",n=e(n),a.append(n),n.fadeIn()},o=function(e){return c("halbfinale"===n.toLowerCase()?e.phases[0]:e.phases[1])},c=function(e){var a="";return _.each(e.encounters,function(e,t){a+=r(e)}),a},r=function(e){var a="",t={teams:e.teams,bestOf:e.bestOf};return a+='<div class="hsc-knockout-game">',a+=s(t),a+='<table class="hsc-knockout-list">',a+=l(e.games),a+="</table>",a+="</div>"},l=function(e){var a="";return _.each(e,function(e,t){a+=i(e)}),a};return{init:function(e){var a=new HockeyDataService;t=e.data("division"),n=e.data("type"),a.getKnockout(t).then(function(a){d(e,a.data)},function(e){console.log("error",e)})}}}e(document).ready(function(){_.templateSettings={interpolate:/\{\{(.+?)\}\}/g},e(".js-hsc-knockout").each(function(){var t=new a;t.init(e(this))})})}(jQuery),function(e){function a(){var a=e("#et-main-area"),n=e(".mobile_menu_bar_toggle");n.on("click",function(n){n.preventDefault(),e(n.currentTarget).hasClass("opened")?(t(),a.show(),e(n.currentTarget).removeClass("opened")):(t(),a.hide(),e(n.currentTarget).addClass("opened"))})}function t(){var a=e(".logo_container");a.animate({top:"-50px"},"fast",function(){window.setTimeout(function(){a.animate({top:"0px"},"fast")},500)})}e(window).load(function(){a()})}(jQuery),function(e){"use strict";var a=function(){var a=new HockeyDataConfig,t="136",n="731",s=function(){return'<div class="no-games">Keine Spiele zur Zeit.</div>'},i=function(){return'<div class="hsc-game-schedule-list-item">  <div class="schedule">    <div class="date">{{ scheduledDate.value }}</div>    <div class="time">- {{ scheduledTime }}</div>  </div>  <div class="game">  <div class="teams">    <div class="team team-home">      <div class="teamlogo"><img src="'+a.logoBaseUrl+'/{{ homeTeamId }}.png" /></div>      <div class="teamname">{{ homeTeamLongName }}</div>    </div>    <div class="divider"></div>    <div class="team team-away">      <div class="teamlogo"><img src="'+a.logoBaseUrl+'/{{ awayTeamId }}.png" /></div>      <div class="teamname">{{ awayTeamLongName }}</div>    </div>  </div>  <div class="scores">      {{ gameStatus > 0 ? homeTeamScore : "-" }}      : {{ gameStatus > 0 ? awayTeamScore : "-" }}  </div>  </div></div>'},d=function(a,t){var n=e('<div class="hsc-game-schedule-list"></div>');a.append(n),o(t.rows,n)},o=function(a,t){var d=_.template(i()),o="",c=1;return 0===a.length?(d=e(s()),t.append(d),d.hide().delay(c*key).fadeIn(),!0):(_.each(a,function(a,s){(a.homeTeamId===n||a.awayTeamId===n)&&("00:00"===a.scheduledTime&&(a.scheduledTime="k.A."),o=e(d(a)),t.append(o),o.hide().delay(c*s).fadeIn())}),!0)};return{init:function(e){var a=new HockeyDataService;t=e.data("division"),n=e.data("team"),a.getSchedule(t).then(function(a){d(e,a.data)},function(e){console.log("error",e)})}}};e(document).ready(function(){_.templateSettings={interpolate:/\{\{(.+?)\}\}/g},e(".js-widget-schedule").each(function(){var t=new a;t.init(e(this))})})}(jQuery),function(e){"use strict";var a=function(){var a=new HockeyDataConfig,t="136",n="731",s="last",i=function(){return'<div class="no-games">Keine Spiele zur Zeit.</div>'},d=function(){var e="last-game-widget";return"next"===s&&(e="next-game-widget"),'<div class="hsc-game-schedule-widget '+e+'"><div class="schedule-widget-holder">  <div class="image image-home-team">    <img src="'+a.logoBaseUrl+'/{{ homeTeamId }}.png" />  </div>  <div class="meta">    <div class="date">{{ scheduledDate.value }}</div>    <div class="time">{{ scheduledTime }}</div>    <div class="scores">{{ homeTeamScore }}:{{ awayTeamScore }}</div>  </div>  <div class="image image-away-team">    <img src="'+a.logoBaseUrl+'/{{ awayTeamId }}.png" />  </div></div>  <div class="teams">    <span class="team home-team">{{ homeTeamLongName }}</span>    <span class="divider">-</span>    <span class="team away-team">{{ awayTeamLongName }}</span>  </div></div>'},o=function(a,t){var n=e('<div class="js-schedule-widget"></div>');a.append(n),c(t.rows,n)},c=function(a,t){var o="",c=_.template(d()),r=moment(),l=!1;if("last"===s){a=_.chain(a).reverse()._wrapped;var u=_.find(a,function(e){if((e.homeTeamId===n||e.awayTeamId===n)&&e.scheduledDate&&e.scheduledDate.value&&e.gameStatus>0){var a=moment(e.scheduledDate.value,"DD.MM.YYYY");if(a.isBefore(r))return e}});u&&(l=!0,"00:00"===u.scheduledTime&&(u.scheduledTime="k.A."),o+=c(u))}if("next"===s){var m=_.find(a,function(e){if((e.homeTeamId===n||e.awayTeamId===n)&&e.scheduledDate&&e.scheduledDate.value&&0===e.gameStatus){var a=moment(e.scheduledDate.value,"DD.MM.YYYY");if(a.isSameOrAfter(r,"day"))return e}});m&&(l=!0,"00:00"===m.scheduledTime&&(m.scheduledTime="k.A."),o+=c(m))}return l?(o=e(o),t.append(o),o.hide().delay("slow").fadeIn(),!0):(c=e(i()),t.append(c),c.hide().delay("slow").fadeIn(),!0)};return{init:function(e){var a=new HockeyDataService;t=e.data("division"),n=e.data("team"),s=e.data("type");a.getSchedule(t).then(function(a){o(e,a.data)},function(e){console.log("error",e)})}}};e(document).ready(function(){_.templateSettings={interpolate:/\{\{(.+?)\}\}/g},e(".js-widget-schedule-single").each(function(){var t=new a;t.init(e(this))})})}(jQuery),function(e){"use strict";function a(){var a=new HockeyDataConfig,t="136",n=function(){return'<tr class="hsc-standings-header"><td class="rank">#</td><td class="image"></td><td class="team">Team</td><td class="info td-gp">Sp</td><td class="info td-w">S</td><td class="info td-l">N</td><td class="info td-otw">OTS</td><td class="info td-otl">OTN</td><td class="info td-goals">Tore</td><td class="info td-gd">TD</td><td class="info td-pts">PKT</td></tr>'},s=function(){return'<tr class="hsc-standings-row"><td class="rank">{{ tableRank }}</td><td class="image"><img src="'+a.logoBaseUrl+'/{{ id }}.png" /></td><td class="team">{{ teamLongname }}</td><td class="info td-gp">{{ gamesPlayed }}</td><td class="info td-w">{{ gamesWon }}</td><td class="info td-l">{{ gamesLost }}</td><td class="info td-otw">{{ gamesWonInOt }}</td><td class="info td-otl">{{ gamesLostInOt }}</td><td class="info td-goals">{{ goalsFor }}:{{ goalsAgainst }}</td><td class="info td-gd">{{ goalDifference }}</td><td class="info td-pts">{{ points }}</td></tr>'},i=function(a,t){var s='<table class="hsc-table hsc-standings">',i=d(t.rows);s+=n(),s+=i,s+="</table>",s=e(s),a.append(s),s.fadeIn()},d=function(e){var a="",t=_.template(s());return _.each(e,function(e,n){a+=t(e)}),a};return{init:function(e){var a=new HockeyDataService;t=e.data("division"),a.getStandings(t).then(function(a){i(e,a.data)},function(e){console.log("error",e)})}}}e(document).ready(function(){_.templateSettings={interpolate:/\{\{(.+?)\}\}/g},e(".js-widget-standings").each(function(){var t=new a;t.init(e(this))})})}(jQuery),function(e){window.HockeyDataService=function(){"use strict";var a=new HockeyDataConfig,t=a.hockeyDataApiUrl,n="/Schedule",s="/Standings",i="/KnockoutStage",d={apiKey:a.hockeyDataApiKey,divisionId:"136",league:a.league,sport:a.sport,referer:a.referer};return{getSchedule:function(a){var s=e.Deferred();d.divisionId=a;var i=e.param(d),o=t+n+"?"+i,c=e.ajax({url:o,dataType:"jsonp",async:!1});return c.success(function(e){return s.resolve(e)}),c.error(function(e){return s.reject({data:{rows:[]}})}),s.promise()},getStandings:function(a){d.divisionId=a;var n=e.param(d),i=t+s+"?"+n;return e.ajax({url:i,dataType:"jsonp"})},getKnockout:function(a){d.divisionId=a;var n=e.param(d),s=t+i+"?"+n;return e.ajax({url:s,dataType:"jsonp"})}}}}(jQuery);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImhvY2tleWRhdGEtY29uZmlnLmpzIiwiY29tcG9uZW50cy9maXhlcy5qcyIsImNvbXBvbmVudHMva25vY2tvdXQuanMiLCJjb21wb25lbnRzL21vYmlsZS1tZW51LmpzIiwiY29tcG9uZW50cy9zY2hlZHVsZS1saXN0LmpzIiwiY29tcG9uZW50cy9zY2hlZHVsZS13aWRnZXQuanMiLCJjb21wb25lbnRzL3N0YW5kaW5ncy5qcyIsInNlcnZpY2VzL2hvY2tleWRhdGEtc2VydmljZS5qcyJdLCJuYW1lcyI6WyIkIiwid2luZG93IiwiSG9ja2V5RGF0YUNvbmZpZyIsImxvZ29CYXNlVXJsIiwiaG9ja2V5RGF0YUFwaVVybCIsImxlYWd1ZSIsInNwb3J0IiwicmVmZXJlciIsImhvY2tleURhdGFBcGlLZXkiLCJqUXVlcnkiLCJhZGRjbGFzcyIsImZuIiwiYWRkQ2xhc3MiLCJyZXN1bHQiLCJhcHBseSIsInRoaXMiLCJhcmd1bWVudHMiLCJyZW1vdmVDbGFzcyIsIkhzY0tub2Nrb3V0IiwiY29uZmlnIiwiZGl2aXNpb25JZCIsInR5cGUiLCJyZXRyaWV2ZUVuY291bnRlck92ZXJ2aWV3VGVtcGxhdGUiLCJkYXRhIiwidGVtcGxhdGUiLCJfIiwicmV0cmlldmVFbmNvdW50ZXJHYW1lVGVtcGxhdGUiLCJnYW1lIiwiYnVpbGRXaWRnZXQiLCIkZWxlbSIsIm91dHB1dCIsInBoYXNlcyIsImJ1aWxkS25vY2tvdXRQaGFzZXMiLCJhcHBlbmQiLCJmYWRlSW4iLCJyZXRyaWV2ZUtub2Nrb3V0UGhhc2UiLCJ0b0xvd2VyQ2FzZSIsInBoYXNlIiwiZWFjaCIsImVuY291bnRlcnMiLCJlbmNvdW50ZXIiLCJrZXkiLCJyZXRyaWV2ZUVuY291bnRlciIsIm92ZXJ2aWV3RGF0YSIsInRlYW1zIiwiYmVzdE9mIiwicmV0cmlldmVFbmNvdW50ZXJHYW1lcyIsImdhbWVzIiwiaW5pdCIsInNlcnZpY2UiLCJIb2NrZXlEYXRhU2VydmljZSIsImdldEtub2Nrb3V0IiwidGhlbiIsInJlc3BvbnNlIiwiY29uc29sZSIsImxvZyIsImRvY3VtZW50IiwicmVhZHkiLCJ0ZW1wbGF0ZVNldHRpbmdzIiwiaW50ZXJwb2xhdGUiLCJ3aWRnZXQiLCJpbml0TW9iaWxlTWVudSIsIiRtYWluQXJlYSIsIiRtZW51QnV0dG9uIiwib24iLCJldmVudCIsInByZXZlbnREZWZhdWx0IiwiY3VycmVudFRhcmdldCIsImhhc0NsYXNzIiwiYW5pbWF0ZUxvZ28iLCJzaG93IiwiaGlkZSIsIiRsb2dvIiwiYW5pbWF0ZSIsInRvcCIsInNldFRpbWVvdXQiLCJsb2FkIiwiSG9ja2V5RGF0YVdpZGdldHNTY2hlZHVsZSIsInRlYW1JZCIsInJldHJpZXZlRW1wdHlUZW1wbGF0ZSIsInJldHJpZXZlUm93VGVtcGxhdGUiLCJsaXN0SG9sZGVyIiwiYnVpbGRSb3dzIiwicm93cyIsImVsZW1lbnQiLCJyb3ciLCJkZWxheSIsImxlbmd0aCIsInZhbHVlIiwiaG9tZVRlYW1JZCIsImF3YXlUZWFtSWQiLCJzY2hlZHVsZWRUaW1lIiwiZ2V0U2NoZWR1bGUiLCJzY2hlZHVsZXMiLCJIb2NrZXlEYXRhV2lkZ2V0c1NjaGVkdWxlU2luZ2xlIiwiY2xhc3NOYW1lIiwiaG9sZGVyIiwidG9kYXkiLCJtb21lbnQiLCJmb3VuZCIsImNoYWluIiwicmV2ZXJzZSIsIl93cmFwcGVkIiwibGFzdEdhbWUiLCJmaW5kIiwic2NoZWR1bGVkRGF0ZSIsImdhbWVTdGF0dXMiLCJnYW1lRGF0ZSIsImlzQmVmb3JlIiwibmV4dEdhbWUiLCJpc1NhbWVPckFmdGVyIiwic2NoZWR1bGVzU2luZ2xlIiwiSG9ja2V5RGF0YVdpZGdldHNTdGFuZGluZ3MiLCJyZXRyaWV2ZUhlYWRlclRlbXBsYXRlIiwiZ2V0U3RhbmRpbmdzIiwic3RhbmRpbmdzIiwiYmFzZVVybCIsInNjaGVkdWxlVXJsIiwic3RhbmRpbmdzVXJsIiwia25vY2tvdXRVcmwiLCJ1cmxQYXJhbXMiLCJhcGlLZXkiLCJkZWZlciIsIkRlZmVycmVkIiwicGFyYW1zIiwicGFyYW0iLCJ1cmwiLCJyZXF1ZXN0IiwiYWpheCIsImRhdGFUeXBlIiwiYXN5bmMiLCJzdWNjZXNzIiwicmVzb2x2ZSIsImVycm9yIiwicmVqZWN0IiwicHJvbWlzZSJdLCJtYXBwaW5ncyI6IkNBQUEsU0FBQUEsR0FDQUMsT0FBQUMsaUJBQUEsV0FDQSxPQUNBQyxZQUFBLDRDQUNBQyxpQkFBQSxzQ0FDQUMsT0FBQSxPQUNBQyxNQUFBLFlBQ0FDLFFBQUEsY0FDQUMsaUJBQUEsc0NBR0FDLFFDWEEsU0FBQVQsR0FDQSxZQUtBLElBQUFVLEdBQUFELE9BQUFFLEdBQUFDLFFBQ0FILFFBQUFFLEdBQUFDLFNBQUEsV0FDQSxHQUFBQyxHQUFBSCxFQUFBSSxNQUFBQyxLQUFBQyxVQUVBLE9BREFQLFFBQUEsZ0JBQUFRLFlBQUEsbUJBQ0FKLEdBR0FiLEVBQUEsZ0JBQUFpQixZQUFBLG9CQUVBUixRQ2ZBLFNBQUFULEdBQ0EsWUFFQSxTQUFBa0IsS0FDQSxHQUFBQyxHQUFBLEdBQUFqQixrQkFDQWtCLEVBQUEsTUFDQUMsRUFBQSxhQUVBQyxFQUFBLFNBQUFDLEdBQ0EsR0FBQUMsR0FBQSw4RUFHQUwsRUFBQWhCLFlBQUEsME9BT0FnQixFQUFBaEIsWUFBQSxnREFNQSxRQUZBcUIsRUFBQUMsRUFBQUQsU0FBQUEsSUFFQUQsSUFHQUcsRUFBQSxTQUFBQyxHQUNBLEdBQUFILEdBQUEsMFBBVUEsUUFGQUEsRUFBQUMsRUFBQUQsU0FBQUEsSUFFQUcsSUFHQUMsRUFBQSxTQUFBQyxFQUFBTixHQUNBLEdBQUFPLEdBQUEsNkJBQ0FDLEVBQUFDLEVBQUFULEVBQ0FPLElBQUFDLEVBQ0FELEdBQUEsU0FFQUEsRUFBQTlCLEVBQUE4QixHQUNBRCxFQUFBSSxPQUFBSCxHQUNBQSxFQUFBSSxVQUdBRixFQUFBLFNBQUFULEdBQ0EsTUFDQVksR0FEQSxlQUFBZCxFQUFBZSxjQUNBYixFQUFBUSxPQUFBLEdBRUFSLEVBQUFRLE9BQUEsS0FJQUksRUFBQSxTQUFBRSxHQUNBLEdBQUFQLEdBQUEsRUFLQSxPQUpBTCxHQUFBYSxLQUFBRCxFQUFBRSxXQUFBLFNBQUFDLEVBQUFDLEdBQ0FYLEdBQUFZLEVBQUFGLEtBR0FWLEdBR0FZLEVBQUEsU0FBQUYsR0FDQSxHQUFBVixHQUFBLEdBQ0FhLEdBQ0FDLE1BQUFKLEVBQUFJLE1BQ0FDLE9BQUFMLEVBQUFLLE9BV0EsT0FSQWYsSUFBQSxrQ0FDQUEsR0FBQVIsRUFBQXFCLEdBRUFiLEdBQUEsb0NBQ0FBLEdBQUFnQixFQUFBTixFQUFBTyxPQUNBakIsR0FBQSxXQUNBQSxHQUFBLFVBS0FnQixFQUFBLFNBQUFDLEdBQ0EsR0FBQWpCLEdBQUEsRUFNQSxPQUpBTCxHQUFBYSxLQUFBUyxFQUFBLFNBQUFwQixFQUFBYyxHQUNBWCxHQUFBSixFQUFBQyxLQUdBRyxFQUdBLFFBQ0FrQixLQUFBLFNBQUFuQixHQUNBLEdBQUFvQixHQUFBLEdBQUFDLGtCQUNBOUIsR0FBQVMsRUFBQU4sS0FBQSxZQUNBRixFQUFBUSxFQUFBTixLQUFBLFFBRUEwQixFQUFBRSxZQUFBL0IsR0FBQWdDLEtBQ0EsU0FBQUMsR0FDQXpCLEVBQUFDLEVBQUF3QixFQUFBOUIsT0FFQSxTQUFBOEIsR0FDQUMsUUFBQUMsSUFBQSxRQUFBRixPQU9BckQsRUFBQXdELFVBQUFDLE1BQUEsV0FDQWhDLEVBQUFpQyxrQkFDQUMsWUFBQSxrQkFHQTNELEVBQUEsb0JBQUFzQyxLQUFBLFdBQ0EsR0FBQXNCLEdBQUEsR0FBQTFDLEVBQ0EwQyxHQUFBWixLQUFBaEQsRUFBQWUsWUFHQU4sUUM5SEEsU0FBQVQsR0FDQSxRQUFBNkQsS0FDQSxHQUFBQyxHQUFBOUQsRUFBQSxpQkFDQStELEVBQUEvRCxFQUFBLDBCQUVBK0QsR0FBQUMsR0FBQSxRQUFBLFNBQUFDLEdBQ0FBLEVBQUFDLGlCQUVBbEUsRUFBQWlFLEVBQUFFLGVBQUFDLFNBQUEsV0FDQUMsSUFDQVAsRUFBQVEsT0FDQXRFLEVBQUFpRSxFQUFBRSxlQUFBbEQsWUFBQSxZQUVBb0QsSUFDQVAsRUFBQVMsT0FDQXZFLEVBQUFpRSxFQUFBRSxlQUFBdkQsU0FBQSxhQUtBLFFBQUF5RCxLQUNBLEdBQUFHLEdBQUF4RSxFQUFBLGtCQUVBd0UsR0FBQUMsU0FDQUMsSUFBQSxTQUNBLE9BQUEsV0FDQXpFLE9BQUEwRSxXQUFBLFdBQ0FILEVBQUFDLFNBQ0FDLElBQUEsT0FDQSxTQUNBLE9BSUExRSxFQUFBQyxRQUFBMkUsS0FBQSxXQUNBZixPQUVBcEQsUUNyQ0EsU0FBQVQsR0FDQSxZQUVBLElBQUE2RSxHQUFBLFdBQ0EsR0FBQTFELEdBQUEsR0FBQWpCLGtCQUNBa0IsRUFBQSxNQUNBMEQsRUFBQSxNQUVBQyxFQUFBLFdBQ0EsTUFBQSxzREFLQUMsRUFBQSxXQUNBLE1BQUEsaVNBUUE3RCxFQUFBaEIsWUFBQSx5TUFLQWdCLEVBQUFoQixZQUFBLDJQQVlBeUIsRUFBQSxTQUFBQyxFQUFBTixHQUNBLEdBQUEwRCxHQUFBakYsRUFBQSw2Q0FDQTZCLEdBQUFJLE9BQUFnRCxHQUNBQyxFQUFBM0QsRUFBQTRELEtBQUFGLElBR0FDLEVBQUEsU0FBQUMsRUFBQUMsR0FDQSxHQUFBNUQsR0FBQUMsRUFBQUQsU0FBQXdELEtBRUFLLEVBQUEsR0FDQUMsRUFBQSxDQUVBLE9BQUEsS0FBQUgsRUFBQUksUUFDQS9ELEVBQUF4QixFQUFBK0UsS0FDQUssRUFBQW5ELE9BQUFULEdBQ0FBLEVBQUErQyxPQUFBZSxNQUFBQSxFQUFBN0MsS0FBQVAsVUFFQSxJQUdBVCxFQUFBYSxLQUFBNkMsRUFBQSxTQUFBSyxFQUFBL0MsSUFDQStDLEVBQUFDLGFBQUFYLEdBQUFVLEVBQUFFLGFBQUFaLEtBQ0EsVUFBQVUsRUFBQUcsZ0JBQ0FILEVBQUFHLGNBQUEsUUFHQU4sRUFBQXJGLEVBQUF3QixFQUFBZ0UsSUFDQUosRUFBQW5ELE9BQUFvRCxHQUNBQSxFQUFBZCxPQUFBZSxNQUFBQSxFQUFBN0MsR0FBQVAsYUFJQSxHQUdBLFFBQ0FjLEtBQUEsU0FBQW5CLEdBQ0EsR0FBQW9CLEdBQUEsR0FBQUMsa0JBQ0E5QixHQUFBUyxFQUFBTixLQUFBLFlBQ0F1RCxFQUFBakQsRUFBQU4sS0FBQSxRQUVBMEIsRUFBQTJDLFlBQUF4RSxHQUFBZ0MsS0FDQSxTQUFBQyxHQUNBekIsRUFBQUMsRUFBQXdCLEVBQUE5QixPQUVBLFNBQUE4QixHQUNBQyxRQUFBQyxJQUFBLFFBQUFGLE9BT0FyRCxHQUFBd0QsVUFBQUMsTUFBQSxXQUNBaEMsRUFBQWlDLGtCQUNBQyxZQUFBLGtCQUdBM0QsRUFBQSx1QkFBQXNDLEtBQUEsV0FDQSxHQUFBdUQsR0FBQSxHQUFBaEIsRUFDQWdCLEdBQUE3QyxLQUFBaEQsRUFBQWUsWUFHQU4sUUN2R0EsU0FBQVQsR0FDQSxZQUNBLElBQUE4RixHQUFBLFdBQ0EsR0FBQTNFLEdBQUEsR0FBQWpCLGtCQUNBa0IsRUFBQSxNQUNBMEQsRUFBQSxNQUNBekQsRUFBQSxPQUVBMEQsRUFBQSxXQUNBLE1BQUEsc0RBS0FDLEVBQUEsV0FDQSxHQUFBZSxHQUFBLGtCQU1BLE9BSkEsU0FBQTFFLElBQ0EwRSxFQUFBLG9CQUdBLHdDQUFBQSxFQUFBLDRGQUdBNUUsRUFBQWhCLFlBQUEsNFJBUUFnQixFQUFBaEIsWUFBQSw0T0FXQXlCLEVBQUEsU0FBQUMsRUFBQU4sR0FDQSxHQUFBeUUsR0FBQWhHLEVBQUEseUNBQ0E2QixHQUFBSSxPQUFBK0QsR0FDQWQsRUFBQTNELEVBQUE0RCxLQUFBYSxJQUdBZCxFQUFBLFNBQUFDLEVBQUFDLEdBQ0EsR0FBQXRELEdBQUEsR0FDQU4sRUFBQUMsRUFBQUQsU0FBQXdELEtBQ0FpQixFQUFBQyxTQUVBQyxHQUFBLENBRUEsSUFBQSxTQUFBOUUsRUFBQSxDQUNBOEQsRUFBQTFELEVBQUEyRSxNQUFBakIsR0FBQWtCLFVBQUFDLFFBQ0EsSUFBQUMsR0FBQTlFLEVBQUErRSxLQUFBckIsRUFBQSxTQUFBRSxHQUNBLElBQUFBLEVBQUFJLGFBQUFYLEdBQUFPLEVBQUFLLGFBQUFaLElBQ0FPLEVBQUFvQixlQUFBcEIsRUFBQW9CLGNBQUFqQixPQUNBSCxFQUFBcUIsV0FBQSxFQUNBLENBQ0EsR0FBQUMsR0FBQVQsT0FBQWIsRUFBQW9CLGNBQUFqQixNQUFBLGFBRUEsSUFBQW1CLEVBQUFDLFNBQUFYLEdBQ0EsTUFBQVosS0FLQWtCLEtBQ0FKLEdBQUEsRUFFQSxVQUFBSSxFQUFBWixnQkFDQVksRUFBQVosY0FBQSxRQUdBN0QsR0FBQU4sRUFBQStFLElBSUEsR0FBQSxTQUFBbEYsRUFBQSxDQUNBLEdBQUF3RixHQUFBcEYsRUFBQStFLEtBQUFyQixFQUFBLFNBQUFFLEdBQ0EsSUFBQUEsRUFBQUksYUFBQVgsR0FBQU8sRUFBQUssYUFBQVosSUFDQU8sRUFBQW9CLGVBQUFwQixFQUFBb0IsY0FBQWpCLE9BQ0EsSUFBQUgsRUFBQXFCLFdBQ0EsQ0FDQSxHQUFBQyxHQUFBVCxPQUFBYixFQUFBb0IsY0FBQWpCLE1BQUEsYUFFQSxJQUFBbUIsRUFBQUcsY0FBQWIsRUFBQSxPQUNBLE1BQUFaLEtBS0F3QixLQUNBVixHQUFBLEVBRUEsVUFBQVUsRUFBQWxCLGdCQUNBa0IsRUFBQWxCLGNBQUEsUUFHQTdELEdBQUFOLEVBQUFxRixJQUlBLE1BQUFWLElBQ0FyRSxFQUFBOUIsRUFBQThCLEdBQ0FzRCxFQUFBbkQsT0FBQUgsR0FDQUEsRUFBQXlDLE9BQUFlLE1BQUEsUUFBQXBELFVBRUEsSUFHQVYsRUFBQXhCLEVBQUErRSxLQUNBSyxFQUFBbkQsT0FBQVQsR0FDQUEsRUFBQStDLE9BQUFlLE1BQUEsUUFBQXBELFVBRUEsR0FHQSxRQUNBYyxLQUFBLFNBQUFuQixHQUNBLEdBQUFvQixHQUFBLEdBQUFDLGtCQUNBOUIsR0FBQVMsRUFBQU4sS0FBQSxZQUNBdUQsRUFBQWpELEVBQUFOLEtBQUEsUUFDQUYsRUFBQVEsRUFBQU4sS0FBQSxPQUVBMEIsR0FBQTJDLFlBQUF4RSxHQUFBZ0MsS0FDQSxTQUFBQyxHQUNBekIsRUFBQUMsRUFBQXdCLEVBQUE5QixPQUVBLFNBQUE4QixHQUNBQyxRQUFBQyxJQUFBLFFBQUFGLE9BUUFyRCxHQUFBd0QsVUFBQUMsTUFBQSxXQUNBaEMsRUFBQWlDLGtCQUNBQyxZQUFBLGtCQUdBM0QsRUFBQSw4QkFBQXNDLEtBQUEsV0FDQSxHQUFBeUUsR0FBQSxHQUFBakIsRUFDQWlCLEdBQUEvRCxLQUFBaEQsRUFBQWUsWUFHQU4sUUN4SkEsU0FBQVQsR0FDQSxZQUVBLFNBQUFnSCxLQUNBLEdBQUE3RixHQUFBLEdBQUFqQixrQkFDQWtCLEVBQUEsTUFHQTZGLEVBQUEsV0FDQSxNQUFBLHlXQWVBakMsRUFBQSxXQUNBLE1BQUEsa0dBRUE3RCxFQUFBaEIsWUFBQSwrYkFhQXlCLEVBQUEsU0FBQUMsRUFBQU4sR0FDQSxHQUFBTyxHQUFBLDBDQUNBcUQsRUFBQUQsRUFBQTNELEVBQUE0RCxLQUNBckQsSUFBQW1GLElBQ0FuRixHQUFBcUQsRUFDQXJELEdBQUEsV0FFQUEsRUFBQTlCLEVBQUE4QixHQUNBRCxFQUFBSSxPQUFBSCxHQUNBQSxFQUFBSSxVQUdBZ0QsRUFBQSxTQUFBQyxHQUNBLEdBQUFyRCxHQUFBLEdBQ0FOLEVBQUFDLEVBQUFELFNBQUF3RCxJQU1BLE9BSkF2RCxHQUFBYSxLQUFBNkMsRUFBQSxTQUFBSyxFQUFBL0MsR0FDQVgsR0FBQU4sRUFBQWdFLEtBR0ExRCxFQUdBLFFBQ0FrQixLQUFBLFNBQUFuQixHQUNBLEdBQUFvQixHQUFBLEdBQUFDLGtCQUNBOUIsR0FBQVMsRUFBQU4sS0FBQSxZQUVBMEIsRUFBQWlFLGFBQUE5RixHQUFBZ0MsS0FDQSxTQUFBQyxHQUNBekIsRUFBQUMsRUFBQXdCLEVBQUE5QixPQUVBLFNBQUE4QixHQUNBQyxRQUFBQyxJQUFBLFFBQUFGLE9BT0FyRCxFQUFBd0QsVUFBQUMsTUFBQSxXQUNBaEMsRUFBQWlDLGtCQUNBQyxZQUFBLGtCQUdBM0QsRUFBQSx3QkFBQXNDLEtBQUEsV0FDQSxHQUFBNkUsR0FBQSxHQUFBSCxFQUNBRyxHQUFBbkUsS0FBQWhELEVBQUFlLFlBR0FOLFFDMUZBLFNBQUFULEdBQ0FDLE9BQUFpRCxrQkFBQSxXQUNBLFlBRUEsSUFBQS9CLEdBQUEsR0FBQWpCLGtCQUNBa0gsRUFBQWpHLEVBQUFmLGlCQUNBaUgsRUFBQSxZQUNBQyxFQUFBLGFBQ0FDLEVBQUEsaUJBRUFDLEdBQ0FDLE9BQUF0RyxFQUFBWCxpQkFDQVksV0FBQSxNQUNBZixPQUFBYyxFQUFBZCxPQUNBQyxNQUFBYSxFQUFBYixNQUNBQyxRQUFBWSxFQUFBWixRQUdBLFFBQ0FxRixZQUFBLFNBQUF4RSxHQUNBLEdBQUFzRyxHQUFBMUgsRUFBQTJILFVBRUFILEdBQUFwRyxXQUFBQSxDQUNBLElBQUF3RyxHQUFBNUgsRUFBQTZILE1BQUFMLEdBQ0FNLEVBQUFWLEVBQUFDLEVBQUEsSUFBQU8sRUFDQUcsRUFBQS9ILEVBQUFnSSxNQUNBRixJQUFBQSxFQUNBRyxTQUFBLFFBQ0FDLE9BQUEsR0FlQSxPQVpBSCxHQUFBSSxRQUFBLFNBQUE5RSxHQUNBLE1BQUFxRSxHQUFBVSxRQUFBL0UsS0FHQTBFLEVBQUFNLE1BQUEsU0FBQWhGLEdBQ0EsTUFBQXFFLEdBQUFZLFFBQ0EvRyxNQUNBNEQsYUFLQXVDLEVBQUFhLFdBR0FyQixhQUFBLFNBQUE5RixHQUNBb0csRUFBQXBHLFdBQUFBLENBQ0EsSUFBQXdHLEdBQUE1SCxFQUFBNkgsTUFBQUwsR0FDQU0sRUFBQVYsRUFBQUUsRUFBQSxJQUFBTSxDQUVBLE9BQUE1SCxHQUFBZ0ksTUFDQUYsSUFBQUEsRUFDQUcsU0FBQSxXQUdBOUUsWUFBQSxTQUFBL0IsR0FDQW9HLEVBQUFwRyxXQUFBQSxDQUNBLElBQUF3RyxHQUFBNUgsRUFBQTZILE1BQUFMLEdBQ0FNLEVBQUFWLEVBQUFHLEVBQUEsSUFBQUssQ0FFQSxPQUFBNUgsR0FBQWdJLE1BQ0FGLElBQUFBLEVBQ0FHLFNBQUEsY0FLQXhIIiwiZmlsZSI6ImhzYy5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oJCkge1xuICAgIHdpbmRvdy5Ib2NrZXlEYXRhQ29uZmlnID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBsb2dvQmFzZVVybDogJy93cC1jb250ZW50L3RoZW1lcy9oc2MtdGhlbWUvaW1hZ2VzL3RlYW1zJyxcbiAgICAgICAgICAgIGhvY2tleURhdGFBcGlVcmw6ICdodHRwOi8vYXBpLmhvY2tleWRhdGEubmV0L2RhdGEvZWJlbCcsXG4gICAgICAgICAgICBsZWFndWU6ICdlYmVsJyxcbiAgICAgICAgICAgIHNwb3J0OiAnaWNlaG9ja2V5JyxcbiAgICAgICAgICAgIHJlZmVyZXI6ICd3d3cuaC1zYy5hdCcsXG4gICAgICAgICAgICBob2NrZXlEYXRhQXBpS2V5OiAnZTUyYjU3MjJjYmM4OWMzZTUxZWUwY2Q2ZTI0ODVhODEnXG4gICAgICAgIH07XG4gICAgfVxufSkoalF1ZXJ5KTtcblxuIiwiKGZ1bmN0aW9uKCQpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIC8vIFN0b3AgZGl2aSBoZWFkZXIgZnJvbSBzaHJpbmtpbmcuXG4gICAgLy8gaHR0cHM6Ly9kaXZpYm9vc3Rlci5jb20vc3RvcC10aGUtZGl2aS1oZWFkZXItZnJvbS1zaHJpbmtpbmctb24tc2Nyb2xsL1xuICAgIC8vIE92ZXJyaWRlIHRoZSBhZGRDbGFzcyB0byBwcmV2ZW50IGZpeGVkIGhlYWRlciBjbGFzcyBmcm9tIGJlaW5nIGFkZGVkXG4gICAgdmFyIGFkZGNsYXNzID0galF1ZXJ5LmZuLmFkZENsYXNzO1xuICAgIGpRdWVyeS5mbi5hZGRDbGFzcyA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHZhciByZXN1bHQgPSBhZGRjbGFzcy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICBqUXVlcnkoJyNtYWluLWhlYWRlcicpLnJlbW92ZUNsYXNzKCdldC1maXhlZC1oZWFkZXInKTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG5cbiAgICAkKCcjbWFpbi1oZWFkZXInKS5yZW1vdmVDbGFzcygnZXQtZml4ZWQtaGVhZGVyJyk7XG5cbn0pKGpRdWVyeSk7XG4iLCIoZnVuY3Rpb24oJCkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgZnVuY3Rpb24gSHNjS25vY2tvdXQoKSB7XG4gICAgICAgIHZhciBjb25maWcgPSBuZXcgSG9ja2V5RGF0YUNvbmZpZygpO1xuICAgICAgICB2YXIgZGl2aXNpb25JZCA9ICcxMzYnO1xuICAgICAgICB2YXIgdHlwZSA9ICdoYWxiZmluYWxlJztcblxuICAgICAgICB2YXIgcmV0cmlldmVFbmNvdW50ZXJPdmVydmlld1RlbXBsYXRlID0gZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgdmFyIHRlbXBsYXRlID0gJzx0YWJsZSBjbGFzcz1cImhzYy1rbm9ja291dC1vdmVydmlld1wiPidcbiAgICAgICAgICAgICAgICArICc8dHI+J1xuICAgICAgICAgICAgICAgICsgJyAgPHRkIGNsYXNzPVwiaW1hZ2VcIj4nXG4gICAgICAgICAgICAgICAgKyAnICAgIDxpbWcgc3JjPVwiJyArIGNvbmZpZy5sb2dvQmFzZVVybCArICcve3sgdGVhbXNbMF0uaWQgfX0ucG5nXCIgLz4nXG4gICAgICAgICAgICAgICAgKyAnICA8L3RkPidcbiAgICAgICAgICAgICAgICArICcgIDx0ZCBjbGFzcz1cIm1ldGFcIj4nXG4gICAgICAgICAgICAgICAgKyAnICAgIDxzcGFuIGNsYXNzPVwic2NvcmVcIj57eyB0ZWFtc1swXS5nYW1lc1dvbiB9fSA6IHt7IHRlYW1zWzFdLmdhbWVzV29uIH19PC9zcGFuPjxici8+J1xuICAgICAgICAgICAgICAgICsgJyAgICA8c3BhbiBjbGFzcz1cImJlc3RvZlwiPkJlc3Qgb2Y6IHt7IGJlc3RPZiB9fTwvc3Bhbj4nXG4gICAgICAgICAgICAgICAgKyAnICA8L3RkPidcbiAgICAgICAgICAgICAgICArICcgIDx0ZCBjbGFzcz1cImltYWdlXCI+J1xuICAgICAgICAgICAgICAgICsgJyAgICA8aW1nIHNyYz1cIicgKyBjb25maWcubG9nb0Jhc2VVcmwgKyAnL3t7IHRlYW1zWzFdLmlkIH19LnBuZ1wiIC8+J1xuICAgICAgICAgICAgICAgICsgJyAgPC90ZD4nXG4gICAgICAgICAgICAgICAgKyAnPC90cj4nXG4gICAgICAgICAgICAgICAgKyAnPC90YWJsZT4nO1xuICAgICAgICAgICAgdGVtcGxhdGUgPSBfLnRlbXBsYXRlKHRlbXBsYXRlKTtcblxuICAgICAgICAgICAgcmV0dXJuIHRlbXBsYXRlKGRhdGEpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHZhciByZXRyaWV2ZUVuY291bnRlckdhbWVUZW1wbGF0ZSA9IGZ1bmN0aW9uKGdhbWUpIHtcbiAgICAgICAgICAgIHZhciB0ZW1wbGF0ZSA9ICc8dHI+J1xuICAgICAgICAgICAgICAgICsgJyAgPHRkIGNsYXNzPVwiZGF0ZVwiIGNvbHNwYW49XCIyXCI+J1xuICAgICAgICAgICAgICAgICsgJyAgICB7eyBzY2hlZHVsZWREYXRlLnZhbHVlIH19IC0ge3sgc2NoZWR1bGVkVGltZSB9fSdcbiAgICAgICAgICAgICAgICArICcgIDwvdGQ+J1xuICAgICAgICAgICAgICAgICsgJzwvdHI+PHRyPidcbiAgICAgICAgICAgICAgICArICcgIDx0ZCBjbGFzcz1cInRlYW1cIj57eyBob21lVGVhbUxvbmdOYW1lIH19IDxici8+IHt7IGF3YXlUZWFtTG9uZ05hbWUgfX08L3RkPidcbiAgICAgICAgICAgICAgICArICcgIDx0ZCBjbGFzcz1cInNjb3JlXCI+e3sgaG9tZVRlYW1TY29yZSB9fSA6IHt7IGF3YXlUZWFtU2NvcmUgfX08L3RkPidcbiAgICAgICAgICAgICAgICArICc8L3RyPic7XG4gICAgICAgICAgICB0ZW1wbGF0ZSA9IF8udGVtcGxhdGUodGVtcGxhdGUpO1xuXG4gICAgICAgICAgICByZXR1cm4gdGVtcGxhdGUoZ2FtZSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIGJ1aWxkV2lkZ2V0ID0gZnVuY3Rpb24oJGVsZW0sIGRhdGEpIHtcbiAgICAgICAgICAgIHZhciBvdXRwdXQgPSAnPGRpdiBjbGFzcz1cImhzYy1rbm9ja291dFwiPic7XG4gICAgICAgICAgICB2YXIgcGhhc2VzID0gYnVpbGRLbm9ja291dFBoYXNlcyhkYXRhKTtcbiAgICAgICAgICAgIG91dHB1dCArPSBwaGFzZXM7XG4gICAgICAgICAgICBvdXRwdXQgKz0gJzwvZGl2Pic7XG5cbiAgICAgICAgICAgIG91dHB1dCA9ICQob3V0cHV0KTtcbiAgICAgICAgICAgICRlbGVtLmFwcGVuZChvdXRwdXQpO1xuICAgICAgICAgICAgb3V0cHV0LmZhZGVJbigpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBidWlsZEtub2Nrb3V0UGhhc2VzID0gZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgaWYgKHR5cGUudG9Mb3dlckNhc2UoKSA9PT0gJ2hhbGJmaW5hbGUnKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJldHJpZXZlS25vY2tvdXRQaGFzZShkYXRhLnBoYXNlc1swXSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiByZXRyaWV2ZUtub2Nrb3V0UGhhc2UoZGF0YS5waGFzZXNbMV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIHZhciByZXRyaWV2ZUtub2Nrb3V0UGhhc2UgPSBmdW5jdGlvbihwaGFzZSkge1xuICAgICAgICAgICAgdmFyIG91dHB1dCA9ICcnO1xuICAgICAgICAgICAgXy5lYWNoKHBoYXNlLmVuY291bnRlcnMsIGZ1bmN0aW9uKGVuY291bnRlciwga2V5KSB7XG4gICAgICAgICAgICAgICAgb3V0cHV0ICs9IHJldHJpZXZlRW5jb3VudGVyKGVuY291bnRlcik7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgcmV0dXJuIG91dHB1dDtcbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgcmV0cmlldmVFbmNvdW50ZXIgPSBmdW5jdGlvbihlbmNvdW50ZXIpIHtcbiAgICAgICAgICAgIHZhciBvdXRwdXQgPSAnJztcbiAgICAgICAgICAgIHZhciBvdmVydmlld0RhdGEgPSB7XG4gICAgICAgICAgICAgICAgdGVhbXM6IGVuY291bnRlci50ZWFtcyxcbiAgICAgICAgICAgICAgICBiZXN0T2Y6IGVuY291bnRlci5iZXN0T2ZcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIG91dHB1dCArPSAnPGRpdiBjbGFzcz1cImhzYy1rbm9ja291dC1nYW1lXCI+JztcbiAgICAgICAgICAgIG91dHB1dCArPSByZXRyaWV2ZUVuY291bnRlck92ZXJ2aWV3VGVtcGxhdGUob3ZlcnZpZXdEYXRhKTtcblxuICAgICAgICAgICAgb3V0cHV0ICs9ICc8dGFibGUgY2xhc3M9XCJoc2Mta25vY2tvdXQtbGlzdFwiPic7XG4gICAgICAgICAgICBvdXRwdXQgKz0gcmV0cmlldmVFbmNvdW50ZXJHYW1lcyhlbmNvdW50ZXIuZ2FtZXMpO1xuICAgICAgICAgICAgb3V0cHV0ICs9ICc8L3RhYmxlPic7XG4gICAgICAgICAgICBvdXRwdXQgKz0gJzwvZGl2Pic7XG5cbiAgICAgICAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIHJldHJpZXZlRW5jb3VudGVyR2FtZXMgPSBmdW5jdGlvbihnYW1lcykge1xuICAgICAgICAgICAgdmFyIG91dHB1dCA9ICcnO1xuXG4gICAgICAgICAgICBfLmVhY2goZ2FtZXMsIGZ1bmN0aW9uKGdhbWUsIGtleSkge1xuICAgICAgICAgICAgICAgIG91dHB1dCArPSByZXRyaWV2ZUVuY291bnRlckdhbWVUZW1wbGF0ZShnYW1lKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICByZXR1cm4gb3V0cHV0O1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBpbml0OiBmdW5jdGlvbigkZWxlbSkge1xuICAgICAgICAgICAgICAgIHZhciBzZXJ2aWNlID0gbmV3IEhvY2tleURhdGFTZXJ2aWNlO1xuICAgICAgICAgICAgICAgIGRpdmlzaW9uSWQgPSAkZWxlbS5kYXRhKCdkaXZpc2lvbicpO1xuICAgICAgICAgICAgICAgIHR5cGUgPSAkZWxlbS5kYXRhKCd0eXBlJyk7XG5cbiAgICAgICAgICAgICAgICBzZXJ2aWNlLmdldEtub2Nrb3V0KGRpdmlzaW9uSWQpLnRoZW4oXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBidWlsZFdpZGdldCgkZWxlbSwgcmVzcG9uc2UuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnZXJyb3InLCByZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcblxuICAgICQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCkge1xuICAgICAgICBfLnRlbXBsYXRlU2V0dGluZ3MgPSB7XG4gICAgICAgICAgICBpbnRlcnBvbGF0ZTogL1xce1xceyguKz8pXFx9XFx9L2dcbiAgICAgICAgfTtcblxuICAgICAgICAkKCcuanMtaHNjLWtub2Nrb3V0JykuZWFjaChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciB3aWRnZXQgPSBuZXcgSHNjS25vY2tvdXQ7XG4gICAgICAgICAgICB3aWRnZXQuaW5pdCgkKHRoaXMpKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG59KShqUXVlcnkpO1xuIiwiKGZ1bmN0aW9uKCQpIHtcbiAgICBmdW5jdGlvbiBpbml0TW9iaWxlTWVudSgpIHtcbiAgICAgICAgdmFyICRtYWluQXJlYSA9ICQoJyNldC1tYWluLWFyZWEnKTtcbiAgICAgICAgdmFyICRtZW51QnV0dG9uID0gJCgnLm1vYmlsZV9tZW51X2Jhcl90b2dnbGUnKTtcblxuICAgICAgICAkbWVudUJ1dHRvbi5vbignY2xpY2snLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICAgICAgaWYgKCQoZXZlbnQuY3VycmVudFRhcmdldCkuaGFzQ2xhc3MoJ29wZW5lZCcpKSB7XG4gICAgICAgICAgICAgICAgYW5pbWF0ZUxvZ28oKTtcbiAgICAgICAgICAgICAgICAkbWFpbkFyZWEuc2hvdygpO1xuICAgICAgICAgICAgICAgICQoZXZlbnQuY3VycmVudFRhcmdldCkucmVtb3ZlQ2xhc3MoJ29wZW5lZCcpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBhbmltYXRlTG9nbygpO1xuICAgICAgICAgICAgICAgICRtYWluQXJlYS5oaWRlKCk7XG4gICAgICAgICAgICAgICAgJChldmVudC5jdXJyZW50VGFyZ2V0KS5hZGRDbGFzcygnb3BlbmVkJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGFuaW1hdGVMb2dvKCkge1xuICAgICAgICB2YXIgJGxvZ28gPSAkKCcubG9nb19jb250YWluZXInKTtcblxuICAgICAgICAkbG9nby5hbmltYXRlKHtcbiAgICAgICAgICAgIHRvcDogJy01MHB4J1xuICAgICAgICB9LCAnZmFzdCcsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgJGxvZ28uYW5pbWF0ZSh7XG4gICAgICAgICAgICAgICAgICAgIHRvcDogJzBweCdcbiAgICAgICAgICAgICAgICB9LCAnZmFzdCcpO1xuICAgICAgICAgICAgfSwgNTAwKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgJCh3aW5kb3cpLmxvYWQoZnVuY3Rpb24oKSB7XG4gICAgICAgIGluaXRNb2JpbGVNZW51KCk7XG4gICAgfSk7XG59KShqUXVlcnkpO1xuIiwiKGZ1bmN0aW9uKCQpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIHZhciBIb2NrZXlEYXRhV2lkZ2V0c1NjaGVkdWxlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBjb25maWcgPSBuZXcgSG9ja2V5RGF0YUNvbmZpZygpO1xuICAgICAgICB2YXIgZGl2aXNpb25JZCA9ICcxMzYnO1xuICAgICAgICB2YXIgdGVhbUlkID0gJzczMSc7XG5cbiAgICAgICAgdmFyIHJldHJpZXZlRW1wdHlUZW1wbGF0ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuICc8ZGl2IGNsYXNzPVwibm8tZ2FtZXNcIj4nXG4gICAgICAgICAgICAgICAgKyAnS2VpbmUgU3BpZWxlIHp1ciBaZWl0LidcbiAgICAgICAgICAgICAgICArICc8L2Rpdj4nO1xuICAgICAgICB9O1xuXG4gICAgICAgIHZhciByZXRyaWV2ZVJvd1RlbXBsYXRlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gJzxkaXYgY2xhc3M9XCJoc2MtZ2FtZS1zY2hlZHVsZS1saXN0LWl0ZW1cIj4nXG4gICAgICAgICAgICAgICAgKyAnICA8ZGl2IGNsYXNzPVwic2NoZWR1bGVcIj4nXG4gICAgICAgICAgICAgICAgKyAnICAgIDxkaXYgY2xhc3M9XCJkYXRlXCI+e3sgc2NoZWR1bGVkRGF0ZS52YWx1ZSB9fTwvZGl2PidcbiAgICAgICAgICAgICAgICArICcgICAgPGRpdiBjbGFzcz1cInRpbWVcIj4tIHt7IHNjaGVkdWxlZFRpbWUgfX08L2Rpdj4nXG4gICAgICAgICAgICAgICAgKyAnICA8L2Rpdj4nXG4gICAgICAgICAgICAgICAgKyAnICA8ZGl2IGNsYXNzPVwiZ2FtZVwiPidcbiAgICAgICAgICAgICAgICArICcgIDxkaXYgY2xhc3M9XCJ0ZWFtc1wiPidcbiAgICAgICAgICAgICAgICArICcgICAgPGRpdiBjbGFzcz1cInRlYW0gdGVhbS1ob21lXCI+J1xuICAgICAgICAgICAgICAgICsgJyAgICAgIDxkaXYgY2xhc3M9XCJ0ZWFtbG9nb1wiPjxpbWcgc3JjPVwiJyArIGNvbmZpZy5sb2dvQmFzZVVybCArICcve3sgaG9tZVRlYW1JZCB9fS5wbmdcIiAvPjwvZGl2PidcbiAgICAgICAgICAgICAgICArICcgICAgICA8ZGl2IGNsYXNzPVwidGVhbW5hbWVcIj57eyBob21lVGVhbUxvbmdOYW1lIH19PC9kaXY+J1xuICAgICAgICAgICAgICAgICsgJyAgICA8L2Rpdj4nXG4gICAgICAgICAgICAgICAgKyAnICAgIDxkaXYgY2xhc3M9XCJkaXZpZGVyXCI+PC9kaXY+J1xuICAgICAgICAgICAgICAgICsgJyAgICA8ZGl2IGNsYXNzPVwidGVhbSB0ZWFtLWF3YXlcIj4nXG4gICAgICAgICAgICAgICAgKyAnICAgICAgPGRpdiBjbGFzcz1cInRlYW1sb2dvXCI+PGltZyBzcmM9XCInICsgY29uZmlnLmxvZ29CYXNlVXJsICsgJy97eyBhd2F5VGVhbUlkIH19LnBuZ1wiIC8+PC9kaXY+J1xuICAgICAgICAgICAgICAgICsgJyAgICAgIDxkaXYgY2xhc3M9XCJ0ZWFtbmFtZVwiPnt7IGF3YXlUZWFtTG9uZ05hbWUgfX08L2Rpdj4nXG4gICAgICAgICAgICAgICAgKyAnICAgIDwvZGl2PidcbiAgICAgICAgICAgICAgICArICcgIDwvZGl2PidcbiAgICAgICAgICAgICAgICArICcgIDxkaXYgY2xhc3M9XCJzY29yZXNcIj4nXG4gICAgICAgICAgICAgICAgKyAnICAgICAge3sgZ2FtZVN0YXR1cyA+IDAgPyBob21lVGVhbVNjb3JlIDogXCItXCIgfX0nXG4gICAgICAgICAgICAgICAgKyAnICAgICAgOiB7eyBnYW1lU3RhdHVzID4gMCA/IGF3YXlUZWFtU2NvcmUgOiBcIi1cIiB9fSdcbiAgICAgICAgICAgICAgICArICcgIDwvZGl2PidcbiAgICAgICAgICAgICAgICArICcgIDwvZGl2PidcbiAgICAgICAgICAgICAgICArICc8L2Rpdj4nO1xuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBidWlsZFdpZGdldCA9IGZ1bmN0aW9uKCRlbGVtLCBkYXRhKSB7XG4gICAgICAgICAgICB2YXIgbGlzdEhvbGRlciA9ICQoJzxkaXYgY2xhc3M9XCJoc2MtZ2FtZS1zY2hlZHVsZS1saXN0XCI+PC9kaXY+Jyk7XG4gICAgICAgICAgICAkZWxlbS5hcHBlbmQobGlzdEhvbGRlcik7XG4gICAgICAgICAgICBidWlsZFJvd3MoZGF0YS5yb3dzLCBsaXN0SG9sZGVyKTtcbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgYnVpbGRSb3dzID0gZnVuY3Rpb24ocm93cywgZWxlbWVudCkge1xuICAgICAgICAgICAgdmFyIHRlbXBsYXRlID0gXy50ZW1wbGF0ZShyZXRyaWV2ZVJvd1RlbXBsYXRlKCkpO1xuICAgICAgICAgICAgdmFyIG91dHB1dCA9ICcnO1xuICAgICAgICAgICAgdmFyIHJvdyA9ICcnO1xuICAgICAgICAgICAgdmFyIGRlbGF5ID0gMTtcblxuICAgICAgICAgICAgaWYgKHJvd3MubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGUgPSAkKHJldHJpZXZlRW1wdHlUZW1wbGF0ZSgpKTtcbiAgICAgICAgICAgICAgICBlbGVtZW50LmFwcGVuZCh0ZW1wbGF0ZSk7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGUuaGlkZSgpLmRlbGF5KGRlbGF5ICoga2V5KS5mYWRlSW4oKTtcblxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBfLmVhY2gocm93cywgZnVuY3Rpb24odmFsdWUsIGtleSkge1xuICAgICAgICAgICAgICAgIGlmICh2YWx1ZS5ob21lVGVhbUlkID09PSB0ZWFtSWQgfHwgdmFsdWUuYXdheVRlYW1JZCA9PT0gdGVhbUlkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZS5zY2hlZHVsZWRUaW1lID09PSAnMDA6MDAnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZS5zY2hlZHVsZWRUaW1lID0gJ2suQS4nO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgcm93ID0gJCh0ZW1wbGF0ZSh2YWx1ZSkpO1xuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmFwcGVuZChyb3cpO1xuICAgICAgICAgICAgICAgICAgICByb3cuaGlkZSgpLmRlbGF5KGRlbGF5ICoga2V5KS5mYWRlSW4oKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGluaXQ6IGZ1bmN0aW9uKCRlbGVtKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNlcnZpY2UgPSBuZXcgSG9ja2V5RGF0YVNlcnZpY2U7XG4gICAgICAgICAgICAgICAgZGl2aXNpb25JZCA9ICRlbGVtLmRhdGEoJ2RpdmlzaW9uJyk7XG4gICAgICAgICAgICAgICAgdGVhbUlkID0gJGVsZW0uZGF0YSgndGVhbScpO1xuXG4gICAgICAgICAgICAgICAgc2VydmljZS5nZXRTY2hlZHVsZShkaXZpc2lvbklkKS50aGVuKFxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYnVpbGRXaWRnZXQoJGVsZW0sIHJlc3BvbnNlLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2Vycm9yJywgcmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG5cbiAgICAkKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigpIHtcbiAgICAgICAgXy50ZW1wbGF0ZVNldHRpbmdzID0ge1xuICAgICAgICAgICAgaW50ZXJwb2xhdGU6IC9cXHtcXHsoLis/KVxcfVxcfS9nXG4gICAgICAgIH07XG5cbiAgICAgICAgJCgnLmpzLXdpZGdldC1zY2hlZHVsZScpLmVhY2goZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgc2NoZWR1bGVzID0gbmV3IEhvY2tleURhdGFXaWRnZXRzU2NoZWR1bGU7XG4gICAgICAgICAgICBzY2hlZHVsZXMuaW5pdCgkKHRoaXMpKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG59KShqUXVlcnkpO1xuIiwiKGZ1bmN0aW9uKCQpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcbiAgICB2YXIgSG9ja2V5RGF0YVdpZGdldHNTY2hlZHVsZVNpbmdsZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgY29uZmlnID0gbmV3IEhvY2tleURhdGFDb25maWcoKTtcbiAgICAgICAgdmFyIGRpdmlzaW9uSWQgPSAnMTM2JztcbiAgICAgICAgdmFyIHRlYW1JZCA9ICc3MzEnO1xuICAgICAgICB2YXIgdHlwZSA9ICdsYXN0JztcblxuICAgICAgICB2YXIgcmV0cmlldmVFbXB0eVRlbXBsYXRlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gJzxkaXYgY2xhc3M9XCJuby1nYW1lc1wiPidcbiAgICAgICAgICAgICAgICArICdLZWluZSBTcGllbGUgenVyIFplaXQuJ1xuICAgICAgICAgICAgICAgICsgJzwvZGl2Pic7XG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIHJldHJpZXZlUm93VGVtcGxhdGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBjbGFzc05hbWUgPSAnbGFzdC1nYW1lLXdpZGdldCc7XG5cbiAgICAgICAgICAgIGlmICh0eXBlID09PSAnbmV4dCcpIHtcbiAgICAgICAgICAgICAgICBjbGFzc05hbWUgPSAnbmV4dC1nYW1lLXdpZGdldCc7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiAnPGRpdiBjbGFzcz1cImhzYy1nYW1lLXNjaGVkdWxlLXdpZGdldCAnICsgY2xhc3NOYW1lICsgJ1wiPidcbiAgICAgICAgICAgICAgICArICc8ZGl2IGNsYXNzPVwic2NoZWR1bGUtd2lkZ2V0LWhvbGRlclwiPidcbiAgICAgICAgICAgICAgICArICcgIDxkaXYgY2xhc3M9XCJpbWFnZSBpbWFnZS1ob21lLXRlYW1cIj4nXG4gICAgICAgICAgICAgICAgKyAnICAgIDxpbWcgc3JjPVwiJyArIGNvbmZpZy5sb2dvQmFzZVVybCArICcve3sgaG9tZVRlYW1JZCB9fS5wbmdcIiAvPidcbiAgICAgICAgICAgICAgICArICcgIDwvZGl2PidcbiAgICAgICAgICAgICAgICArICcgIDxkaXYgY2xhc3M9XCJtZXRhXCI+J1xuICAgICAgICAgICAgICAgICsgJyAgICA8ZGl2IGNsYXNzPVwiZGF0ZVwiPnt7IHNjaGVkdWxlZERhdGUudmFsdWUgfX08L2Rpdj4nXG4gICAgICAgICAgICAgICAgKyAnICAgIDxkaXYgY2xhc3M9XCJ0aW1lXCI+e3sgc2NoZWR1bGVkVGltZSB9fTwvZGl2PidcbiAgICAgICAgICAgICAgICArICcgICAgPGRpdiBjbGFzcz1cInNjb3Jlc1wiPnt7IGhvbWVUZWFtU2NvcmUgfX06e3sgYXdheVRlYW1TY29yZSB9fTwvZGl2PidcbiAgICAgICAgICAgICAgICArICcgIDwvZGl2PidcbiAgICAgICAgICAgICAgICArICcgIDxkaXYgY2xhc3M9XCJpbWFnZSBpbWFnZS1hd2F5LXRlYW1cIj4nXG4gICAgICAgICAgICAgICAgKyAnICAgIDxpbWcgc3JjPVwiJyArIGNvbmZpZy5sb2dvQmFzZVVybCArICcve3sgYXdheVRlYW1JZCB9fS5wbmdcIiAvPidcbiAgICAgICAgICAgICAgICArICcgIDwvZGl2PidcbiAgICAgICAgICAgICAgICArICc8L2Rpdj4nXG4gICAgICAgICAgICAgICAgKyAnICA8ZGl2IGNsYXNzPVwidGVhbXNcIj4nXG4gICAgICAgICAgICAgICAgKyAnICAgIDxzcGFuIGNsYXNzPVwidGVhbSBob21lLXRlYW1cIj57eyBob21lVGVhbUxvbmdOYW1lIH19PC9zcGFuPidcbiAgICAgICAgICAgICAgICArICcgICAgPHNwYW4gY2xhc3M9XCJkaXZpZGVyXCI+LTwvc3Bhbj4nXG4gICAgICAgICAgICAgICAgKyAnICAgIDxzcGFuIGNsYXNzPVwidGVhbSBhd2F5LXRlYW1cIj57eyBhd2F5VGVhbUxvbmdOYW1lIH19PC9zcGFuPidcbiAgICAgICAgICAgICAgICArICcgIDwvZGl2PidcbiAgICAgICAgICAgICAgICArICc8L2Rpdj4nO1xuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBidWlsZFdpZGdldCA9IGZ1bmN0aW9uKCRlbGVtLCBkYXRhKSB7XG4gICAgICAgICAgICB2YXIgaG9sZGVyID0gJCgnPGRpdiBjbGFzcz1cImpzLXNjaGVkdWxlLXdpZGdldFwiPjwvZGl2PicpO1xuICAgICAgICAgICAgJGVsZW0uYXBwZW5kKGhvbGRlcik7XG4gICAgICAgICAgICBidWlsZFJvd3MoZGF0YS5yb3dzLCBob2xkZXIpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBidWlsZFJvd3MgPSBmdW5jdGlvbihyb3dzLCBlbGVtZW50KSB7XG4gICAgICAgICAgICB2YXIgb3V0cHV0ID0gJyc7XG4gICAgICAgICAgICB2YXIgdGVtcGxhdGUgPSBfLnRlbXBsYXRlKHJldHJpZXZlUm93VGVtcGxhdGUoKSk7XG4gICAgICAgICAgICB2YXIgdG9kYXkgPSBtb21lbnQoKTtcbiAgICAgICAgICAgIHZhciBsaW1pdCA9IDE7XG4gICAgICAgICAgICB2YXIgZm91bmQgPSBmYWxzZTtcblxuICAgICAgICAgICAgaWYgKHR5cGUgPT09ICdsYXN0Jykge1xuICAgICAgICAgICAgICAgIHJvd3MgPSBfLmNoYWluKHJvd3MpLnJldmVyc2UoKS5fd3JhcHBlZDtcbiAgICAgICAgICAgICAgICB2YXIgbGFzdEdhbWUgPSBfLmZpbmQocm93cywgZnVuY3Rpb24ocm93KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICgocm93LmhvbWVUZWFtSWQgPT09IHRlYW1JZCB8fCByb3cuYXdheVRlYW1JZCA9PT0gdGVhbUlkKVxuICAgICAgICAgICAgICAgICAgICAgICAgJiYgKHJvdy5zY2hlZHVsZWREYXRlICYmIHJvdy5zY2hlZHVsZWREYXRlLnZhbHVlKVxuICAgICAgICAgICAgICAgICAgICAgICAgJiYgcm93LmdhbWVTdGF0dXMgPiAwXG4gICAgICAgICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdhbWVEYXRlID0gbW9tZW50KHJvdy5zY2hlZHVsZWREYXRlLnZhbHVlLCAnREQuTU0uWVlZWScpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ2FtZURhdGUuaXNCZWZvcmUodG9kYXkpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJvdztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgaWYgKGxhc3RHYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvdW5kID0gdHJ1ZTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAobGFzdEdhbWUuc2NoZWR1bGVkVGltZSA9PT0gJzAwOjAwJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGFzdEdhbWUuc2NoZWR1bGVkVGltZSA9ICdrLkEuJztcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIG91dHB1dCArPSB0ZW1wbGF0ZShsYXN0R2FtZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodHlwZSA9PT0gJ25leHQnKSB7XG4gICAgICAgICAgICAgICAgdmFyIG5leHRHYW1lID0gXy5maW5kKHJvd3MsIGZ1bmN0aW9uKHJvdykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoKHJvdy5ob21lVGVhbUlkID09PSB0ZWFtSWQgfHwgcm93LmF3YXlUZWFtSWQgPT09IHRlYW1JZClcbiAgICAgICAgICAgICAgICAgICAgICAgICYmIChyb3cuc2NoZWR1bGVkRGF0ZSAmJiByb3cuc2NoZWR1bGVkRGF0ZS52YWx1ZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICYmIHJvdy5nYW1lU3RhdHVzID09PSAwXG4gICAgICAgICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdhbWVEYXRlID0gbW9tZW50KHJvdy5zY2hlZHVsZWREYXRlLnZhbHVlLCAnREQuTU0uWVlZWScpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ2FtZURhdGUuaXNTYW1lT3JBZnRlcih0b2RheSwgJ2RheScpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJvdztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgaWYgKG5leHRHYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvdW5kID0gdHJ1ZTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAobmV4dEdhbWUuc2NoZWR1bGVkVGltZSA9PT0gJzAwOjAwJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV4dEdhbWUuc2NoZWR1bGVkVGltZSA9ICdrLkEuJztcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIG91dHB1dCArPSB0ZW1wbGF0ZShuZXh0R2FtZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoZm91bmQpIHtcbiAgICAgICAgICAgICAgICBvdXRwdXQgPSAkKG91dHB1dCk7XG4gICAgICAgICAgICAgICAgZWxlbWVudC5hcHBlbmQob3V0cHV0KTtcbiAgICAgICAgICAgICAgICBvdXRwdXQuaGlkZSgpLmRlbGF5KCdzbG93JykuZmFkZUluKCk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGVtcGxhdGUgPSAkKHJldHJpZXZlRW1wdHlUZW1wbGF0ZSgpKTtcbiAgICAgICAgICAgIGVsZW1lbnQuYXBwZW5kKHRlbXBsYXRlKTtcbiAgICAgICAgICAgIHRlbXBsYXRlLmhpZGUoKS5kZWxheSgnc2xvdycpLmZhZGVJbigpO1xuXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgaW5pdDogZnVuY3Rpb24oJGVsZW0pIHtcbiAgICAgICAgICAgICAgICB2YXIgc2VydmljZSA9IG5ldyBIb2NrZXlEYXRhU2VydmljZTtcbiAgICAgICAgICAgICAgICBkaXZpc2lvbklkID0gJGVsZW0uZGF0YSgnZGl2aXNpb24nKTtcbiAgICAgICAgICAgICAgICB0ZWFtSWQgPSAkZWxlbS5kYXRhKCd0ZWFtJyk7XG4gICAgICAgICAgICAgICAgdHlwZSA9ICRlbGVtLmRhdGEoJ3R5cGUnKTtcblxuICAgICAgICAgICAgICAgIHZhciBkYXRhID0gc2VydmljZS5nZXRTY2hlZHVsZShkaXZpc2lvbklkKS50aGVuKFxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYnVpbGRXaWRnZXQoJGVsZW0sIHJlc3BvbnNlLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2Vycm9yJywgcmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gYnVpbGRXaWRnZXQoJGVsZW0sIEpTT04ucGFyc2UocmVzcG9uc2UuZGF0YSkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG5cbiAgICAkKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigpIHtcbiAgICAgICAgXy50ZW1wbGF0ZVNldHRpbmdzID0ge1xuICAgICAgICAgICAgaW50ZXJwb2xhdGU6IC9cXHtcXHsoLis/KVxcfVxcfS9nXG4gICAgICAgIH07XG5cbiAgICAgICAgJCgnLmpzLXdpZGdldC1zY2hlZHVsZS1zaW5nbGUnKS5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIHNjaGVkdWxlc1NpbmdsZSA9IG5ldyBIb2NrZXlEYXRhV2lkZ2V0c1NjaGVkdWxlU2luZ2xlO1xuICAgICAgICAgICAgc2NoZWR1bGVzU2luZ2xlLmluaXQoJCh0aGlzKSk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xufSkoalF1ZXJ5KTtcbiIsIihmdW5jdGlvbigkKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBmdW5jdGlvbiBIb2NrZXlEYXRhV2lkZ2V0c1N0YW5kaW5ncygpIHtcbiAgICAgICAgdmFyIGNvbmZpZyA9IG5ldyBIb2NrZXlEYXRhQ29uZmlnKCk7XG4gICAgICAgIHZhciBkaXZpc2lvbklkID0gJzEzNic7XG4gICAgICAgIHZhciB0ZWFtSWQgPSAnNzMxJztcblxuICAgICAgICB2YXIgcmV0cmlldmVIZWFkZXJUZW1wbGF0ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuICc8dHIgY2xhc3M9XCJoc2Mtc3RhbmRpbmdzLWhlYWRlclwiPidcbiAgICAgICAgICAgICAgICArICc8dGQgY2xhc3M9XCJyYW5rXCI+IzwvdGQ+J1xuICAgICAgICAgICAgICAgICsgJzx0ZCBjbGFzcz1cImltYWdlXCI+PC90ZD4nXG4gICAgICAgICAgICAgICAgKyAnPHRkIGNsYXNzPVwidGVhbVwiPlRlYW08L3RkPidcbiAgICAgICAgICAgICAgICArICc8dGQgY2xhc3M9XCJpbmZvIHRkLWdwXCI+U3A8L3RkPidcbiAgICAgICAgICAgICAgICArICc8dGQgY2xhc3M9XCJpbmZvIHRkLXdcIj5TPC90ZD4nXG4gICAgICAgICAgICAgICAgKyAnPHRkIGNsYXNzPVwiaW5mbyB0ZC1sXCI+TjwvdGQ+J1xuICAgICAgICAgICAgICAgICsgJzx0ZCBjbGFzcz1cImluZm8gdGQtb3R3XCI+T1RTPC90ZD4nXG4gICAgICAgICAgICAgICAgKyAnPHRkIGNsYXNzPVwiaW5mbyB0ZC1vdGxcIj5PVE48L3RkPidcbiAgICAgICAgICAgICAgICArICc8dGQgY2xhc3M9XCJpbmZvIHRkLWdvYWxzXCI+VG9yZTwvdGQ+J1xuICAgICAgICAgICAgICAgICsgJzx0ZCBjbGFzcz1cImluZm8gdGQtZ2RcIj5URDwvdGQ+J1xuICAgICAgICAgICAgICAgICsgJzx0ZCBjbGFzcz1cImluZm8gdGQtcHRzXCI+UEtUPC90ZD4nXG4gICAgICAgICAgICAgICAgKyAnPC90cj4nO1xuICAgICAgICB9O1xuXG4gICAgICAgIHZhciByZXRyaWV2ZVJvd1RlbXBsYXRlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gJzx0ciBjbGFzcz1cImhzYy1zdGFuZGluZ3Mtcm93XCI+J1xuICAgICAgICAgICAgICAgICsgJzx0ZCBjbGFzcz1cInJhbmtcIj57eyB0YWJsZVJhbmsgfX08L3RkPidcbiAgICAgICAgICAgICAgICArICc8dGQgY2xhc3M9XCJpbWFnZVwiPjxpbWcgc3JjPVwiJyArIGNvbmZpZy5sb2dvQmFzZVVybCArICcve3sgaWQgfX0ucG5nXCIgLz48L3RkPidcbiAgICAgICAgICAgICAgICArICc8dGQgY2xhc3M9XCJ0ZWFtXCI+e3sgdGVhbUxvbmduYW1lIH19PC90ZD4nXG4gICAgICAgICAgICAgICAgKyAnPHRkIGNsYXNzPVwiaW5mbyB0ZC1ncFwiPnt7IGdhbWVzUGxheWVkIH19PC90ZD4nXG4gICAgICAgICAgICAgICAgKyAnPHRkIGNsYXNzPVwiaW5mbyB0ZC13XCI+e3sgZ2FtZXNXb24gfX08L3RkPidcbiAgICAgICAgICAgICAgICArICc8dGQgY2xhc3M9XCJpbmZvIHRkLWxcIj57eyBnYW1lc0xvc3QgfX08L3RkPidcbiAgICAgICAgICAgICAgICArICc8dGQgY2xhc3M9XCJpbmZvIHRkLW90d1wiPnt7IGdhbWVzV29uSW5PdCB9fTwvdGQ+J1xuICAgICAgICAgICAgICAgICsgJzx0ZCBjbGFzcz1cImluZm8gdGQtb3RsXCI+e3sgZ2FtZXNMb3N0SW5PdCB9fTwvdGQ+J1xuICAgICAgICAgICAgICAgICsgJzx0ZCBjbGFzcz1cImluZm8gdGQtZ29hbHNcIj57eyBnb2Fsc0ZvciB9fTp7eyBnb2Fsc0FnYWluc3QgfX08L3RkPidcbiAgICAgICAgICAgICAgICArICc8dGQgY2xhc3M9XCJpbmZvIHRkLWdkXCI+e3sgZ29hbERpZmZlcmVuY2UgfX08L3RkPidcbiAgICAgICAgICAgICAgICArICc8dGQgY2xhc3M9XCJpbmZvIHRkLXB0c1wiPnt7IHBvaW50cyB9fTwvdGQ+J1xuICAgICAgICAgICAgICAgICsgJzwvdHI+JztcbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgYnVpbGRXaWRnZXQgPSBmdW5jdGlvbigkZWxlbSwgZGF0YSkge1xuICAgICAgICAgICAgdmFyIG91dHB1dCA9ICc8dGFibGUgY2xhc3M9XCJoc2MtdGFibGUgaHNjLXN0YW5kaW5nc1wiPic7XG4gICAgICAgICAgICB2YXIgcm93cyA9IGJ1aWxkUm93cyhkYXRhLnJvd3MpO1xuICAgICAgICAgICAgb3V0cHV0ICs9IHJldHJpZXZlSGVhZGVyVGVtcGxhdGUoKTtcbiAgICAgICAgICAgIG91dHB1dCArPSByb3dzO1xuICAgICAgICAgICAgb3V0cHV0ICs9ICc8L3RhYmxlPic7XG5cbiAgICAgICAgICAgIG91dHB1dCA9ICQob3V0cHV0KTtcbiAgICAgICAgICAgICRlbGVtLmFwcGVuZChvdXRwdXQpO1xuICAgICAgICAgICAgb3V0cHV0LmZhZGVJbigpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBidWlsZFJvd3MgPSBmdW5jdGlvbihyb3dzKSB7XG4gICAgICAgICAgICB2YXIgb3V0cHV0ID0gJyc7XG4gICAgICAgICAgICB2YXIgdGVtcGxhdGUgPSBfLnRlbXBsYXRlKHJldHJpZXZlUm93VGVtcGxhdGUoKSk7XG5cbiAgICAgICAgICAgIF8uZWFjaChyb3dzLCBmdW5jdGlvbih2YWx1ZSwga2V5KSB7XG4gICAgICAgICAgICAgICAgb3V0cHV0ICs9IHRlbXBsYXRlKHZhbHVlKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICByZXR1cm4gb3V0cHV0O1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBpbml0OiBmdW5jdGlvbigkZWxlbSkge1xuICAgICAgICAgICAgICAgIHZhciBzZXJ2aWNlID0gbmV3IEhvY2tleURhdGFTZXJ2aWNlO1xuICAgICAgICAgICAgICAgIGRpdmlzaW9uSWQgPSAkZWxlbS5kYXRhKCdkaXZpc2lvbicpO1xuXG4gICAgICAgICAgICAgICAgc2VydmljZS5nZXRTdGFuZGluZ3MoZGl2aXNpb25JZCkudGhlbihcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1aWxkV2lkZ2V0KCRlbGVtLCByZXNwb25zZS5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdlcnJvcicsIHJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKSB7XG4gICAgICAgIF8udGVtcGxhdGVTZXR0aW5ncyA9IHtcbiAgICAgICAgICAgIGludGVycG9sYXRlOiAvXFx7XFx7KC4rPylcXH1cXH0vZ1xuICAgICAgICB9O1xuXG4gICAgICAgICQoJy5qcy13aWRnZXQtc3RhbmRpbmdzJykuZWFjaChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBzdGFuZGluZ3MgPSBuZXcgSG9ja2V5RGF0YVdpZGdldHNTdGFuZGluZ3M7XG4gICAgICAgICAgICBzdGFuZGluZ3MuaW5pdCgkKHRoaXMpKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG59KShqUXVlcnkpO1xuIiwiKGZ1bmN0aW9uKCQpIHtcbiAgICB3aW5kb3cuSG9ja2V5RGF0YVNlcnZpY2UgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICAgICAgdmFyIGNvbmZpZyA9IG5ldyBIb2NrZXlEYXRhQ29uZmlnKCk7XG4gICAgICAgIHZhciBiYXNlVXJsID0gY29uZmlnLmhvY2tleURhdGFBcGlVcmw7XG4gICAgICAgIHZhciBzY2hlZHVsZVVybCA9ICcvU2NoZWR1bGUnO1xuICAgICAgICB2YXIgc3RhbmRpbmdzVXJsID0gJy9TdGFuZGluZ3MnO1xuICAgICAgICB2YXIga25vY2tvdXRVcmwgPSAnL0tub2Nrb3V0U3RhZ2UnO1xuXG4gICAgICAgIHZhciB1cmxQYXJhbXMgPSB7XG4gICAgICAgICAgICBhcGlLZXk6IGNvbmZpZy5ob2NrZXlEYXRhQXBpS2V5LFxuICAgICAgICAgICAgZGl2aXNpb25JZDogJzEzNicsXG4gICAgICAgICAgICBsZWFndWU6IGNvbmZpZy5sZWFndWUsXG4gICAgICAgICAgICBzcG9ydDogY29uZmlnLnNwb3J0LFxuICAgICAgICAgICAgcmVmZXJlcjogY29uZmlnLnJlZmVyZXJcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZ2V0U2NoZWR1bGU6IGZ1bmN0aW9uKGRpdmlzaW9uSWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGVmZXIgPSAkLkRlZmVycmVkKCk7XG5cbiAgICAgICAgICAgICAgICB1cmxQYXJhbXMuZGl2aXNpb25JZCA9IGRpdmlzaW9uSWQ7XG4gICAgICAgICAgICAgICAgdmFyIHBhcmFtcyA9ICQucGFyYW0odXJsUGFyYW1zKTtcbiAgICAgICAgICAgICAgICB2YXIgdXJsID0gYmFzZVVybCArIHNjaGVkdWxlVXJsICsgJz8nICsgcGFyYW1zO1xuICAgICAgICAgICAgICAgIHZhciByZXF1ZXN0ID0gJC5hamF4KHtcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB1cmwsXG4gICAgICAgICAgICAgICAgICAgIGRhdGFUeXBlOiBcImpzb25wXCIsXG4gICAgICAgICAgICAgICAgICAgIGFzeW5jOiBmYWxzZVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgcmVxdWVzdC5zdWNjZXNzKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkZWZlci5yZXNvbHZlKHJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHJlcXVlc3QuZXJyb3IoZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRlZmVyLnJlamVjdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcm93czogW11cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmZXIucHJvbWlzZSgpO1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZ2V0U3RhbmRpbmdzOiBmdW5jdGlvbihkaXZpc2lvbklkKSB7XG4gICAgICAgICAgICAgICAgdXJsUGFyYW1zLmRpdmlzaW9uSWQgPSBkaXZpc2lvbklkO1xuICAgICAgICAgICAgICAgIHZhciBwYXJhbXMgPSAkLnBhcmFtKHVybFBhcmFtcyk7XG4gICAgICAgICAgICAgICAgdmFyIHVybCA9IGJhc2VVcmwgKyBzdGFuZGluZ3NVcmwgKyAnPycgKyBwYXJhbXM7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gJC5hamF4KHtcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB1cmwsXG4gICAgICAgICAgICAgICAgICAgIGRhdGFUeXBlOiBcImpzb25wXCJcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBnZXRLbm9ja291dDogZnVuY3Rpb24oZGl2aXNpb25JZCkge1xuICAgICAgICAgICAgICAgIHVybFBhcmFtcy5kaXZpc2lvbklkID0gZGl2aXNpb25JZDtcbiAgICAgICAgICAgICAgICB2YXIgcGFyYW1zID0gJC5wYXJhbSh1cmxQYXJhbXMpO1xuICAgICAgICAgICAgICAgIHZhciB1cmwgPSBiYXNlVXJsICsga25vY2tvdXRVcmwgKyAnPycgKyBwYXJhbXM7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gJC5hamF4KHtcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB1cmwsXG4gICAgICAgICAgICAgICAgICAgIGRhdGFUeXBlOiBcImpzb25wXCJcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG59KShqUXVlcnkpO1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
